(this["webpackJsonpcorp-frontend"]=this["webpackJsonpcorp-frontend"]||[]).push([[0],{125:function(e,t,r){},187:function(e,t,r){},267:function(e,t,r){},268:function(e,t,r){},269:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(15),s=r.n(c),l=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,290)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;r(e),n(e),a(e),c(e),s(e)}))},i=r(40),o=r(281),u=r(286),j=r(36),d=r(62),b=r(37),h=r.n(b),p=r(44),f=r.n(p);function x(){return(x=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/audit/api/corp/structures");case 2:return t=e.sent,console.log("get structures in api 1"),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}f.a.defaults.xsrfHeaderName="X-CSRFToken";var O=r(64),m=r(16),g=r(275),v=r(50),y=r(289),S=r(65),w=r(84),F=r(276),N=r(277),C=r(278),P=r(149),L=r(287),k=r(279),z=(r(187),r(125),r(2)),_=function(){return Object(z.jsx)(u.a.Body,{className:"flex-container",children:Object(z.jsxs)("div",{className:"text-center",children:[Object(z.jsx)("div",{className:"error-size bottom-text",children:Object(z.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100",height:"100",fill:"currentColor",class:"bi bi-exclamation-triangle error-anim",viewBox:"0 0 16 16",children:[Object(z.jsx)("path",{d:"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z"}),Object(z.jsx)("path",{d:"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z"})]})}),Object(z.jsx)("h3",{className:"text-margin",children:"Error Loading Component"})]})})},B={option:function(e){return Object(m.a)(Object(m.a)({},e),{},{color:"black"})}};function H(e){var t=e.message;return Object(z.jsx)(g.a,{id:"character_tooltip",children:t})}function A(e){var t=e.column;t.filterValue,t.preFilteredRows,t.setFilter;return Object(z.jsx)(z.Fragment,{})}function T(e){var t=e.column,r=t.filterValue,n=t.preFilteredRows,a=t.setFilter,c=n.length;return Object(z.jsx)("input",{className:"form-control",value:r||"",onChange:function(e){a(e.target.value||void 0)},placeholder:"Search ".concat(c," records...")})}function R(e){var t=e.column,r=t.setFilter,n=t.filterValue,c=t.preFilteredRows,s=t.id,l=a.a.useMemo((function(){var e=new Set;return c?(c.forEach((function(t){null!==t.values[s]&&("object"===typeof t.values[s]?e.add(t.values[s].name):e.add(t.values[s]))})),Object(i.a)(e.values())):[]}),[s,c]);return Object(z.jsx)(O.a,{title:n,onChange:function(e){return r(e.value)},value:{label:n||"All"},defaultValue:{label:"All"},styles:B,options:[{id:-1,value:"",label:"All"}].concat(l.map((function(e,t){return{id:t,value:e,label:e}})))},n)}var M=function(){return{}},D=function(e){var t=e.isLoading,r=e.isFetching,n=e.data,c=e.error,s=e.columns,l=e.getRowProps,i=void 0===l?M:l,o=a.a.useMemo((function(){return{Filter:A}}),[]),u=a.a.useMemo((function(){return{text:function(e,t,r){return e.filter((function(e){return t.some((function(t){if(r){var n=e.values[t];return"object"===typeof n&&(n=n.name),!!n&&n.toLowerCase().includes(r.toLowerCase())}return!0}))}))}}}),[]),j=Object(S.useTable)({columns:s,data:n,defaultColumn:o,filterTypes:u,initialState:{pageSize:20}},S.useFilters,S.useSortBy,S.usePagination),d=j.getTableProps,b=j.getTableBodyProps,h=j.headerGroups,p=j.page,f=j.prepareRow,x=j.canPreviousPage,O=j.canNextPage,g=j.pageOptions,B=j.pageCount,T=j.gotoPage,R=j.nextPage,D=j.previousPage,E=j.setPageSize,V=j.state,I=V.pageIndex,Q=V.pageSize;return t?Object(z.jsx)("div",{className:"col-xs-12 text-center",children:Object(z.jsx)(w.a,{className:"spinner-size"})}):c?Object(z.jsx)(_,{}):Object(z.jsxs)(z.Fragment,{children:[Object(z.jsxs)(F.a,{striped:!0,children:[Object(z.jsxs)("thead",Object(m.a)(Object(m.a)({},d()),{},{children:[h.map((function(e){return Object(z.jsx)("tr",Object(m.a)(Object(m.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(z.jsxs)("th",Object(m.a)(Object(m.a)({},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(z.jsx)("span",{className:"pull-right",children:e.canSort?e.isSorted?e.isSortedDesc?Object(z.jsx)(N.a,{glyph:"sort-by-attributes-alt"}):Object(z.jsx)(N.a,{glyph:"sort-by-attributes"}):Object(z.jsx)(N.a,{glyph:"sort"}):""})]}))}))}))})),h.map((function(e){return Object(z.jsx)("tr",Object(m.a)(Object(m.a)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return Object(z.jsx)("th",Object(m.a)(Object(m.a)({},e.getHeaderProps()),{},{children:Object(z.jsx)("div",{children:e.canFilter?e.render("Filter"):null})}))}))}))}))]})),Object(z.jsx)("tbody",Object(m.a)(Object(m.a)({},b()),{},{children:p.map((function(e,t){return f(e),Object(z.jsx)("tr",Object(m.a)(Object(m.a)({},e.getRowProps(i(e))),{},{children:e.cells.map((function(e){return Object(z.jsx)("td",Object(m.a)(Object(m.a)({style:{verticalAlign:"middle"}},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}))]}),Object(z.jsx)("div",{className:"pagination pull-right",children:Object(z.jsxs)(C.a,{children:[Object(z.jsxs)(P.a,{children:[Object(z.jsx)(v.a,{bsStyle:"success",onClick:function(){return T(0)},disabled:!x,children:Object(z.jsx)(N.a,{glyph:"step-backward"})})," ",Object(z.jsx)(v.a,{bsStyle:"success",onClick:function(){return D()},disabled:!x,children:Object(z.jsx)(N.a,{glyph:"triangle-left"})})," ",Object(z.jsx)(v.a,{bsStyle:"success",onClick:function(){return R()},disabled:!O,children:Object(z.jsx)(N.a,{glyph:"triangle-right"})})," ",Object(z.jsx)(v.a,{bsStyle:"success",onClick:function(){return T(B-1)},disabled:!O,children:Object(z.jsx)(N.a,{glyph:"step-forward"})})]}),Object(z.jsxs)(P.a,{children:[Object(z.jsx)(v.a,{active:!0,bsStyle:"success",children:"Page Size:"})," ",Object(z.jsx)(L.a,{id:"pageSizeDropdown",bsStyle:"success",title:Q,onSelect:function(e){E(Number(e))},children:[20,50,100,1e6].map((function(e){return Object(z.jsxs)(k.a,{id:e,eventKey:e,value:e,children:["Show ",e]},e)}))})]})]})}),Object(z.jsx)("div",{className:"pagination pull-left",children:Object(z.jsxs)(P.a,{children:[Object(z.jsx)(v.a,{active:!0,bsStyle:"info",children:Object(z.jsx)(z.Fragment,{children:g.length>0?Object(z.jsxs)(z.Fragment,{children:["Page"," ",Object(z.jsxs)("strong",{children:[I+1," of ",g.length]})]}):Object(z.jsxs)(z.Fragment,{children:["Page ",Object(z.jsx)("strong",{children:"- of -"})]})})})," ",r?Object(z.jsx)(y.a,{placement:"bottom",overlay:H({message:"Refreshing Data"}),children:Object(z.jsx)(v.a,{bsStyle:"info",children:Object(z.jsx)(N.a,{className:"glyphicon-refresh-animate",glyph:"refresh"})})}):Object(z.jsx)(y.a,{placement:"bottom",overlay:H({message:"Data Loaded: "+(new Date).toLocaleString()}),children:Object(z.jsx)(v.a,{bsStyle:"info",children:Object(z.jsx)(N.a,{glyph:"ok"})})})]})})]})},E=r(285),V=r(280),I=function(e){var t=e.corporation_id,r=e.size,n=void 0===r?256:r;return Object(z.jsx)(V.a,{src:"https://images.evetech.net/corporations/".concat(t,"/logo?size=").concat(n)})},Q=function(e){var t=e.type_id,r=e.size,n=void 0===r?64:r;return Object(z.jsx)(V.a,{className:"img-circle",src:"https://images.evetech.net/types/".concat(t,"/icon?size=").concat(n)})},G=r(284),W=r(153);G.a.addDefaultLocale(W);var X=function(){var e=Object(j.useQuery)(["stuctures"],(function(){return function(){return x.apply(this,arguments)}()}),{initialData:[]}),t=e.isLoading,r=e.isFetching,n=e.error,c=e.data,s=a.a.useMemo((function(){return function(e,t,r){var n=e.values[r],a=t.values[r];return null===n|null===a||n>a?1:-1}}),[]),l=a.a.useMemo((function(){return[{Header:"System",accessor:"location",Filter:R,filter:"text",Cell:function(e){return Object(z.jsx)("a",{href:"https://evemaps.dotlan.net/system/"+e.value.name.replace(" ","_"),children:e.value.name})}},{Header:"Structure",accessor:"name",Filter:T,filter:"text"},{Header:"Type",accessor:"type",disableSortBy:!0,Filter:R,filter:"text",Cell:function(e){return Object(z.jsxs)("div",{className:"flex-image-text",children:[Object(z.jsx)("div",{className:"pull-left",children:Object(z.jsx)(Q,{type_id:e.value.id})}),Object(z.jsx)("div",{className:"pull-left",children:e.value.name})]})}},{Header:"Owner",accessor:"owner",disableSortBy:!0,Filter:function(e){var t=e.column,r=t.setFilter,n=t.filterValue,c=t.preFilteredRows,s=t.id,l=a.a.useMemo((function(){var e=new Set;return c?(c.forEach((function(t){null!==t.values[s]&&e.add(t.values[s].corporation_name)})),Object(i.a)(e.values())):[]}),[s,c]);return Object(z.jsx)(O.a,{title:n,onChange:function(e){return r(e.value)},value:{label:n||"All"},defaultValue:{label:"All"},styles:B,options:[{id:-1,value:"",label:"All"}].concat(l.map((function(e,t){return{id:t,value:e,label:e}})))},n)},filter:function(e,t,r){return e.filter((function(e){return t.some((function(t){if(r){var n=e.values[t].corporation_name;return!!n&&n.toLowerCase().includes(r.toLowerCase())}return!0}))}))},Cell:function(e){return Object(z.jsxs)("div",{className:"flex-image-text",children:[Object(z.jsx)("div",{className:"pull-left",children:Object(z.jsx)(I,{corporation_id:e.value.corporation_id,size:32})}),Object(z.jsx)("div",{className:"pull-left",children:e.value.corporation_name})]})}},{Header:"Fuel Expiry",accessor:"fuel_expiry",sortType:s,Cell:function(e){return Object(z.jsx)("div",{children:e.value?Object(z.jsx)(E.a,{date:e.value}):""})}},{Header:"State",accessor:"state",Filter:R,disableSortBy:!0,filter:"text"},{Header:"Services",accessor:"services",disableSortBy:!0,Filter:function(e){var t=e.column,r=t.setFilter,n=t.filterValue,c=t.preFilteredRows,s=t.id,l=a.a.useMemo((function(){var e=new Set;return c?(c.forEach((function(t){null!==t.values[s]&&t.values[s].forEach((function(t){e.add(t.name)}))})),Object(i.a)(e.values())):[]}),[s,c]);return Object(z.jsx)(O.a,{title:n,onChange:function(e){return r(e.value)},value:{label:n||"All"},defaultValue:{label:"All"},styles:B,options:[{id:-1,value:"",label:"All"}].concat(l.map((function(e,t){return{id:t,value:e,label:e}})))},n)},filter:function(e,t,r){return e.filter((function(e){return t.some((function(t){if(r){var n=e.values[t].reduce((function(e,t){return e+"  "+t.name}),"");return!!n&&n.toLowerCase().includes(r.toLowerCase())}return!0}))}))},Cell:function(e){return e.value?Object(z.jsx)("div",{className:"text-center",children:e.value.map((function(e){return Object(z.jsx)(o.a,{className:"padded-label",bsStyle:"online"===e.state?"primary":"danger",children:e.name})}))}):Object(z.jsx)(z.Fragment,{})}}]}),[s]);return Object(z.jsx)(u.a.Body,{children:Object(z.jsx)(D,{isLoading:t,isFetching:r,data:c,columns:l,error:n})})},J=r(103),U=r(17),K=r(283),q=r(288),Y=r(282),Z=r(1),$=function(e){var t=Object(U.f)();Object(n.useEffect)((function(){}),[t]);var r=window.location.href.endsWith(e.href)?"active":"";return Object(z.jsx)(Y.a,Object(m.a)(Object(m.a)({className:r},e),{},{children:e.children}))};$.contextTypes={router:r.n(Z).a.object};var ee=$,te=(r(267),r(155)),re=r.n(te);function ne(){return(ne=Object(d.a)(h.a.mark((function e(){var t,r,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.a.get("/audit/api/corp/list");case 2:return t=e.sent,console.log("got corp status in api"),(r=Array.from(new Set(t.data.reduce((function(e,t){try{return e.concat(Object.keys(t.last_updates))}catch(r){return e}}),[])))).sort(),n={corps:t.data,headers:r},e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(){return ce.apply(this,arguments)}function ce(){return(ce=Object(d.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Sent Corp refresh"),e.next=3,f.a.post("/audit/api/corporation/refresh",{headers:{"X-CSRFToken":re.a.getItem("csrftoken")}});case 3:return t=e.sent,e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){var t=e.message;return Object(z.jsx)(g.a,{id:"character_tooltip",children:t})}f.a.defaults.xsrfHeaderName="X-CSRFToken";var le=function(){var e=Object(j.useMutation)(ae).mutate;return Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(Y.a,{href:"/audit/corp/add",children:Object(z.jsx)(y.a,{placement:"top",overlay:se({message:"Add New Token"}),children:Object(z.jsx)(N.a,{glyph:"plus"})})}),Object(z.jsx)(Y.a,{onClick:function(){return e()},children:Object(z.jsx)(N.a,{glyph:"refresh"})})]})},ie=function(){return Object(z.jsxs)(q.a,{fluid:!0,collapseOnSelect:!0,children:[Object(z.jsxs)(q.a.Header,{children:[Object(z.jsx)(q.a.Brand,{children:"Corporation Audit"}),Object(z.jsx)(q.a.Toggle,{})]}),Object(z.jsxs)(q.a.Collapse,{children:[Object(z.jsxs)(K.a,{children:[Object(z.jsx)(ee,{href:"#/structures",children:"Structures"},"Structures"),Object(z.jsx)(ee,{href:"#/wallets",children:"Wallets"},"Wallets"),Object(z.jsx)(ee,{href:"#/assets",children:"Assets"},"Assets")]}),Object(z.jsxs)(K.a,{className:"pull-right",children:[Object(z.jsx)(le,{}),Object(z.jsx)(ee,{href:"#/status",children:"Corporations"},"Status")]})]})]})},oe=function(){return Object(z.jsx)(u.a.Body,{className:"flex-container",children:Object(z.jsx)(w.a,{className:"spinner-size"})})},ue=function(){var e=Object(j.useQuery)(["corp-status"],(function(){return function(){return ne.apply(this,arguments)}()})),t=e.isLoading,r=e.error,n=e.data;return t?Object(z.jsx)(oe,{}):r?Object(z.jsx)(_,{}):Object(z.jsx)(u.a.Body,{className:"flex-container",children:n.corps.map((function(e){return Object(z.jsxs)(u.a,{className:"flex-child",children:[Object(z.jsx)(u.a.Heading,{children:Object(z.jsx)("h4",{className:"text-center",children:e.corporation.corporation_name})}),Object(z.jsxs)(u.a.Body,{className:"flex-body",children:[Object(z.jsx)("div",{className:"text-center",children:Object(z.jsx)(I,{corporation_id:e.corporation.corporation_id,size:256})}),Object(z.jsx)("h4",{className:"text-center",children:"Update Status"}),Object(z.jsx)(F.a,{striped:!0,style:{marginBottom:0},children:Object(z.jsx)("thead",{children:Object(z.jsxs)("tr",{children:[Object(z.jsx)("th",{children:"Update"}),Object(z.jsx)("th",{className:"text-right",children:"Last Run"})]})})}),Object(z.jsx)("div",{className:"table-div",children:Object(z.jsx)(F.a,{striped:!0,children:Object(z.jsx)("tbody",{children:n.headers.map((function(t){return Object(z.jsxs)("tr",{children:[Object(z.jsx)("td",{children:t}),Object(z.jsx)("td",{className:"text-right",children:e.last_updates[t]?Object(z.jsx)(E.a,{date:Date.parse(e.last_updates[t])}):Object(z.jsx)(z.Fragment,{children:"Never"})})]})}))})})})]})]})}))})},je=(r(268),new j.QueryClient);s.a.render(Object(z.jsx)(a.a.StrictMode,{children:Object(z.jsx)(J.a,{children:Object(z.jsxs)(j.QueryClientProvider,{client:je,children:[Object(z.jsx)("br",{}),Object(z.jsx)(ie,{}),Object(z.jsx)(u.a,{bsStyle:"default",children:Object(z.jsxs)(U.c,{children:[Object(z.jsx)(U.a,{exact:!0,path:["","/structures"],component:function(){return X()}}),Object(z.jsx)(U.a,{path:"/wallets",component:function(){return _()}}),Object(z.jsx)(U.a,{path:"/status",component:function(){return ue()}}),Object(z.jsx)(U.a,{path:"/assets",component:function(){return _()}})]})})]})})}),document.getElementById("root")),l(console.log)}},[[269,1,2]]]);
//# sourceMappingURL=main.42e73db9.chunk.js.map
